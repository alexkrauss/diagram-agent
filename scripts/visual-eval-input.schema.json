{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Visual Eval Input",
  "description": "Input format for the visual judge evaluation. Contains test cases with turns, each having criteria to evaluate.",
  "type": "object",
  "required": ["tests"],
  "properties": {
    "tests": {
      "type": "array",
      "description": "List of test cases to evaluate",
      "items": {
        "type": "object",
        "required": ["turns"],
        "properties": {
          "fullName": {
            "type": "string",
            "description": "Full name/identifier of the test case"
          },
          "turns": {
            "type": "array",
            "description": "Conversation turns within the test",
            "items": {
              "type": "object",
              "required": ["criteria", "turnEvents"],
              "properties": {
                "turnIndex": {
                  "type": "integer",
                  "description": "Index of this turn in the conversation"
                },
                "turnEvents": {
                  "type": "array",
                  "description": "Events that occurred during this turn, in chronological order",
                  "items": {
                    "type": "object",
                    "required": ["type"],
                    "properties": {
                      "type": {
                        "type": "string",
                        "enum": ["user_message", "assistant_message", "tool_call"],
                        "description": "Type of event"
                      },
                      "content": {
                        "type": "string",
                        "description": "Message content (for user_message and assistant_message)"
                      },
                      "toolName": {
                        "type": "string",
                        "description": "Name of the tool called (for tool_call)"
                      },
                      "arguments": {
                        "description": "Arguments passed to the tool (for tool_call)"
                      }
                    }
                  }
                },
                "pngPath": {
                  "type": ["string", "null"],
                  "description": "Relative path to the PNG image to evaluate, or null if no image was produced"
                },
                "criteria": {
                  "type": "array",
                  "description": "List of criteria to judge the image against",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
